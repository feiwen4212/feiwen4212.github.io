---
layout: post
title:  "推荐系统学习整理"
date:   2017-01-25 14:07:10 +0530
categories: notes
---
<!--<!DOCTYPE html>-->
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><p>最近做课程项目是与小伙伴们打算做一个电影推荐系统，数据采用的是Nitflex推荐系统竞赛数据。于是花时间整理了一下平时学习的推荐系统常用的一些方法。其中相似度的整理在下一篇<a href="https://feiwen4212.github.io/notes/2017/02/05/Sim-Culculation-notes.1.html">相似度计算整理笔记</a>。</p>
<h2 id="一、推荐系统">一、推荐系统</h2>
<p>  推荐系统很好理解，就是如何通过分析学习用户反馈或用户属性来预测用户对物品的喜好程度。用户反馈可以分为显式的和隐式的，说说我对这两种用户反馈的理。<br>
  显示用户反馈是是用户主动对物品做出的喜好反馈，比如用户对商品的打分或者用户对评价的评价。而隐式的用户反馈则是通过用户的行为分析出的用户喜好，比如用户搜索的关键字、用户浏览点击的商品、用户购买的商品等。<br>
  一般来说显式的用户反馈更加精准，直接代表用户的偏好程度，但需要付出用户额外代价获得，比隐式反馈会少。举例来说我买了淘宝上的某件商品，如果不好不坏用着凑合我并不会特地去给商品打分评论，但这类打分因为是主动行为往往能准确反映用户的喜好。而隐式的反馈比如我历史上购买的记录、搜索过的关键字、点击查看过的商品等信息都是随时都会被产生和记录的，但并不意味着购买的物品就是我喜好的，比如我买了一件女装给朋友不代表我本身就喜欢女装。这类信息往往无法判断用户对物品的喜好，且夹杂着大量的噪音（买 != 喜欢）。但我们可以近似的理解为置信度，比如我查看的频繁的物品我喜欢的置信度更高。</p>
<p>传统的推荐算法主要有以下几类<br>
1） 基于内容的推荐<br>
2） 协同过滤推荐<br>
3） 混合模型推荐</p>
<h2 id="二、基于内容的推荐">二、基于内容的推荐</h2>
<p>  这类的推荐主要是通过用户和物品的信息挖掘出用户和物品的profile。<br>
  User profile（用户画像）是一个挺热门方法，用户画像是通过分析用户的人口统计属性和用户的反馈信息给用户打标签，这些标签组成的画像是为了更加精准地刻画出用户的特征，从而对用户进行个性化推荐。当然，用户画像应用不止于此，比如通过建立画像分析用户流失、分析用户偿付能力、进行精准营销等，这些方面的应用再次不详细说（其实是我不怎么懂哈哈）。<br>
  同理，Item profile也是有类似的方法建立，往往很多商品自带标签。就拿电影来举例，电影的标签可以有类别、导演、上映时间、演员…而许多标签需要对商品的文本或介绍进行分析获得，还是拿电影举例，电影泰坦尼克号，我们从电影介绍中提取出关键词“游轮、穷小子、白富美、爱情悲剧”，这些标签就很好的刻画了电影的情节特征。说到关键词，这里就不得不提一下经典的关键词提取算法TF/IDF了，在很多文档推荐时都应用到了这种算法，比附推荐论文，推荐新闻。<br>
总结一下基于内容的推荐，我们可以总结出以下过程：<br>
<strong>物品/用户 -&gt; 特征/画像 -&gt; 相似度 -&gt; 推荐</strong></p>
<p>  当然当我们获得了用户画像以后也可以应用机器学习的模型来预测用户对商品的喜好。举个栗子来说，比如最近火热的那篇《Practical Lessons from Predicting Clicks on Ads at Facebook》中通过学习用户特征来进行CTR的预测。当然我们可以把CTR预测理解成是建立一个广告推荐系统，原理上是大同小异的。</p>
<h3 id="优点"><strong>优点</strong></h3>
<p>1）这类推荐往往能够挖掘出用户的小众偏好<br>
2）对于item的冷启动往往十分有效，通过建立item profile能够快速找到目标人群<br>
3）相较于协同过滤的解释性更高</p>
<h3 id="缺点"><strong>缺点</strong></h3>
<p>1）挖掘profile存在一定难度和风险，比如通过提取关键词来建立物品profile时提取关键词的质量无法保证，建立的profile偏差可能较大<br>
2）较差的profile建立往往直接导致推荐质量低下<br>
3）很难给用户推荐带来惊喜</p>
<h2 id="三、基于协同过滤的推荐">三、基于协同过滤的推荐</h2>
<p>  协同过滤是通过分析学习用户对物品的打分的评分矩阵进行建模的。这个矩阵往往是极度稀疏的，所以无法使用传统的机器学习方法对打分进行学习，而协同过滤算法对处理稀疏数据往往有很好的效果。<br>
协同过滤的算法可以非为以下几类：<br>
1）基于用户的协同过滤（User based CF）<br>
2）基于物品的协同过滤（Item based CF）<br>
3）基于模型的协同过滤（Model based CF）</p>
<h3 id="基于用户的协同过滤和基于物品的协同过滤">1. 基于用户的协同过滤和基于物品的协同过滤</h3>
<p>  在这里我把这两个模型放在一起说，因为从原理上来说这两种方法是极度相似的。首先说基于用户的协同过滤，简单来说算法可以分为三个步骤<br>
1）通过用户打分形成的稀疏向量计算与用户最相似的k个用户，其中计算相似度的方法会在下一篇学习笔记中整理。<br>
2）找出相似用户喜欢而目标用户没有消费的物品，并计算目标用户对这些物品的打分<br>
3）对物品排序，提取top N对用户做推荐。<br>
再说说基于物品的推荐吧，大致也可以分为三个步骤<br>
1）通过物品已有的用户打分稀疏向量计算物品之间的相似度<br>
2）通过用户已经打分物品计算找出与该物品相似度高的未消费物品<br>
3）对物品排序，提取top N对用户推荐</p>
<p><strong>接下来我们说说这两中方法的异同以及优缺点。</strong><br>
1）基于用户的协同过滤考虑适应用户的动态变化在在线推荐系统中计更新需求大，而基于物品的协同过滤便于离线计算。<br>
2）基于物品的推荐往往推荐用户评分过的同类物品，而基于用户的协同过滤则能够发掘出新的物品能够给用户一些新奇的推荐。<br>
3）在新用户冷启动的情景下，基于物品的协同过滤能够快速根据用户的第一次购买做出反应，而基于用户的协同过滤则需要在用户有一定量的物品评价后计算与其他商品的相似度进行推荐，所以这种情况下基于物品的推荐系统更加优秀。<br>
4）而在新物品的冷启动场景下，同理基于用户的推荐会相对反应更快<br>
5）最后一点，其实前几点就提到过，基于用户的协同过滤考虑时效性和用户的动态变化需要频繁更新，较为复杂</p>
<h3 id="基于模型的协同过滤">2. 基于模型的协同过滤</h3>
<p>  这类模型其实比较广泛，可以包括聚类、分类、矩阵分解。聚类和分类模型其实可以参考上面在基于内容的推荐最后提到的使用机器学习算法学习建立模型。矩阵分解则是在推荐系统中十分常见的一类方法，比如大名鼎鼎的SVD，SVD++，ALS等，这类算法其实是将打分矩阵分解成用户特征矩阵和物品特征矩阵，通过用户特征向量和物品特征向量估计用户打分。<br>
  这里主要讲一下ALS（Alternating Least Squares matrix factorization），原因是这次课程项目中就用到了ALS算法。ALS相对于其他的同类算法存在其优越性，这一点从到目前为止Spark中只有这一种推荐算法就能看出。其实ALS算法是MS（Matrix Factoriazation）的一种。<br>
首先来说一下MF的一般求解问题<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>i</mi><mi>n</mi><msub><mo>∑</mo><mrow><msub><mi>r</mi><mrow><mi>u</mi><mi>i</mi></mrow></msub><mo≯</mo><mo>=</mo><mn>0</mn></mrow></msub><mo>(</mo><msub><mi>r</mi><mrow><mi>u</mi><mi>i</mi></mrow></msub><mo>−</mo><msubsup><mi>x</mi><mi>u</mi><mi>T</mi></msubsup><msub><mi>y</mi><mi>i</mi></msub><msup><mo>)</mo><mn>2</mn></msup><mo>+</mo><mi>λ</mi><mo>(</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>u</mi></msub><mi mathvariant="normal">∣</mi><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup><mo>+</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msub><mi>y</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">min\sum_{r_{ui}\not=0}(r_{ui}-x_{u}^{T}y_{i})^{2}+\lambda (||x_{u}||^{2}+||y_{i}||^{2})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 1.05001em;"></span><span class="strut bottom" style="height: 2.48823em; vertical-align: -1.43822em;"></span><span class="base"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.84789em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-left: -0.02778em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"></span></span></span></span></span><span class="mrel mtight" style="position: relative;"><span class="mainrm" style="position: absolute; right: 0px;"≯</span><span class="mrel mtight">=</span></span><span class="mord mathrm mtight">0</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.43822em;"></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">2</span></span></span></span></span></span></span></span></span><span class="mbin">+</span><span class="mord mathit">λ</span><span class="mopen">(</span><span class="mord mathrm">∣</span><span class="mord mathrm">∣</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span><span class="mord mathrm">∣</span><span class="mord"><span class="mord mathrm">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">2</span></span></span></span></span></span></span></span></span><span class="mbin">+</span><span class="mord mathrm">∣</span><span class="mord mathrm">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span><span class="mord mathrm">∣</span><span class="mord"><span class="mord mathrm">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br>
其中<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>r</mi><mrow><mi>u</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">r_{ui}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.43056em;"></span><span class="strut bottom" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span></span></span></span></span>是用户 u 对物品 i 的打分，<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">x_{u}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.43056em;"></span><span class="strut bottom" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.43056em;"></span><span class="strut bottom" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span></span></span></span></span> 分别是用户向量和物品向量。通过最小上式损失函数，我们可以得到最佳的“特征向量”来描述每一个用户和物品，从而达到对用户未消费的物品打分预测。<br>
ALS对这个损失函数进行扩展，引进了额外的变量<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mrow><mi>u</mi><mi>i</mi></mrow></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>&nbsp;if&nbsp;</mtext><msub><mi>r</mi><mrow><mi>u</mi><mi>i</mi></mrow></msub><mo>⩾</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>0</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>&nbsp;if&nbsp;</mtext><msub><mi>r</mi><mrow><mi>u</mi><mi>i</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
p_{ui}=\begin{cases} 
 1 &amp; \text{ if } r_{ui} \geqslant  0 \\ 
 0 &amp; \text{ if } r_{ui} = 0
\end{cases}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 1.75em;"></span><span class="strut bottom" style="height: 3.00003em; vertical-align: -1.25003em;"></span><span class="base"><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span><span class="mrel">=</span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.69em;"><span class="" style="top: -3.69em;"><span class="pstrut" style="height: 3.008em;"></span><span class="mord"><span class="mord mathrm">1</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.008em;"></span><span class="mord"><span class="mord mathrm">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.19em;"></span></span></span></span><span class="arraycolsep" style="width: 1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.69em;"><span class="" style="top: -3.69em;"><span class="pstrut" style="height: 3.008em;"></span><span class="mord"><span class="mord text"><span class="mord mathrm">&nbsp;if&nbsp;</span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span><span class="mrel amsrm">⩾</span><span class="mord mathrm">0</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.008em;"></span><span class="mord"><span class="mord text"><span class="mord mathrm">&nbsp;if&nbsp;</span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.19em;"></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span><br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mrow><mi>u</mi><mi>i</mi></mrow></msub><mo>=</mo><mn>1</mn><mo>+</mo><mi>α</mi><msub><mi>r</mi><mrow><mi>u</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">c_{ui}=1+\alpha r_{ui}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.64444em;"></span><span class="strut bottom" style="height: 0.79444em; vertical-align: -0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mbin">+</span><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span></span></span></span></span></span><br>
<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mrow><mi>u</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">p_{ui}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.43056em;"></span><span class="strut bottom" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="base"><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span></span></span></span></span>是一个二值的变量，描述了用户 u 对物品 i 的偏好。当用户 u 消费了物品 i 时，我们用户是对该物品存在偏好的，否则为不存在偏好。但是这种描述是不准确的，就如我在解释隐式反馈中举的例子，不够买不代表不喜欢，购买也不代表喜欢。因此引入另一个变量<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mrow><mi>u</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">c_{ui}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.43056em;"></span><span class="strut bottom" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span></span></span></span></span>用以描述<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mrow><mi>u</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">p_{ui}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.43056em;"></span><span class="strut bottom" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="base"><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span></span></span></span></span>的置信度。论文作者通过实验得出结论<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.43056em;"></span><span class="strut bottom" style="height: 0.43056em; vertical-align: 0em;"></span><span class="base"><span class="mord mathit" style="margin-right: 0.0037em;">α</span></span></span></span></span>的值设置在40时得到的结果较好。<br>
有了这两个变量，改进后的模型变为了下式<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>i</mi><mi>n</mi><msub><mo>∑</mo><mrow><mi>u</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub><msub><mi>c</mi><mrow><mi>u</mi><mi>i</mi></mrow></msub><mo>(</mo><msub><mi>p</mi><mrow><mi>u</mi><mi>i</mi></mrow></msub><mo>−</mo><msubsup><mi>x</mi><mi>u</mi><mi>T</mi></msubsup><msub><mi>y</mi><mi>i</mi></msub><msup><mo>)</mo><mn>2</mn></msup><mo>+</mo><mi>λ</mi><mo>(</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>u</mi></msub><mi mathvariant="normal">∣</mi><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup><mo>+</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msub><mi>y</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">min\sum_{u,i}c_{ui}(p_{ui}-x_{u}^{T}y_{i})^{2}+\lambda (||x_{u}||^{2}+||y_{i}||^{2})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 1.05001em;"></span><span class="strut bottom" style="height: 2.46378em; vertical-align: -1.41378em;"></span><span class="base"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.41378em;"></span></span></span></span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">2</span></span></span></span></span></span></span></span></span><span class="mbin">+</span><span class="mord mathit">λ</span><span class="mopen">(</span><span class="mord mathrm">∣</span><span class="mord mathrm">∣</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span><span class="mord mathrm">∣</span><span class="mord"><span class="mord mathrm">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">2</span></span></span></span></span></span></span></span></span><span class="mbin">+</span><span class="mord mathrm">∣</span><span class="mord mathrm">∣</span><span class="mord"><span class="mord mathit" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span><span class="mord mathrm">∣</span><span class="mord"><span class="mord mathrm">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span></p>
<p>而真正的主角ALS之后才出现，为啥我说真正的主角呢？ALS（Alternating Least Squares matrix factorization）交替最小二乘如果光看这个名字其实这是一种求解最优化的方法，而我们提到的算法ALS其实是使用了交替最小二乘来求矩阵分解的一种算法。那ALS究竟干了些啥呢，首先来理解一下字面上的意思，最小二乘我们懂，在求解线性回归等使用二阶损失函数的优化问题中我们都可以见得着，那交替最小二乘是个啥么？直接翻译论文中的解释，交替最小二乘就是交替的对用户向量和物品向量重新计算，使得每一步都能保证使得损失函数降低。其实可以理解为对用户向量和物品向量每次固定一个，对另一个求解最优化问题，交替进行直到收敛。</p>
<h3 id="协同过滤的优缺点"><strong>协同过滤的优缺点</strong></h3>
<p>1）相较于基于内容的推荐，协同过滤不需要了解相关领域的知识，使用的是评分矩阵，通用性较强<br>
2）工程上实现简单，模型效果好<br>
3）模型存在热门推荐倾向，对小众推荐不友好</p>
<h2 id="四、混合模型推荐">四、混合模型推荐</h2>
<p>这种推荐其实是混合上述推荐的模型，这种模型一般推荐效果比单个模型好，但是需要在实际场合权衡不同模型的混合，通常混合有几种策略<br>
1）多种模型加权推荐<br>
2）特定场合切换模型<br>
3）特征扩展：将一个模型输出当作另一个模型的特征输入<br>
4）特征混合：将不同模型的特征组合在一起训练模型</p>
<h2 id="参考引用">参考引用</h2>
<p>[1] Hu, Y., Koren, Y., &amp; Volinsky, C. (2009). Collaborative Filtering for Implicit Feedback Datasets. Eighth IEEE International Conference on Data Mining (pp.263-272). IEEE.<br>
[2]Aleksandra Klašnja-Milićević, Mirjana Ivanović, & Alexandros Nanopoulos. (2015). Recommender systems in e-learning environments: a survey of the state-of-the-art and possible extensions. Artificial Intelligence Review, 44(4), 571-604.  <br>
[3] https://www.cnblogs.com/NeilHappy/p/4622741.html<br>
[4] https://www.jianshu.com/p/c432edca79b9<br>
[5] 学校数据挖掘课程，课程主页以及失效了</p>
</div>
</body>

</html>
